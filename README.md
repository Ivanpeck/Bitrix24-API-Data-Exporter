# Bitrix24-API-Data-Exporter
Скрипт для автоматизированной выгрузки данных о лидах и сделках из Bitrix24 в формате Excel с помощью REST API.

## Назначение
Этот инструмент предназначен для бизнес-аналитиков и маркетологов, которым требуется регулярно получать из Bitrix24:

Объединенные данные по сделкам и связанным с ними лидам

Детальную информацию о лидах, пришедших через веб-формы

Автоматическое преобразование сложных структур данных Bitrix24 в удобный табличный формат

## Возможности
Выгрузка данных: Получение статусов, пользователей, лидов и сделок из Bitrix24

Преобразование данных: Обработка и соединение данных из разных источников

Экспорт в Excel: Сохранение результатов в два отдельных файла:

Выгрузка 1.xlsx - Сделки с информацией о связанных лидах

Выгрузка 2.xlsx - Лиды, созданные через веб-формы

Обработка ошибок: Защита от сбоев при обращении к API Bitrix24

## Установка и настройка
Предварительные требования
Python 3.7+

Учетная запись Bitrix24 с доступом к REST API

Вебхук с правами на чтение данных CRM

Настройка вебхука
Получите вебхук в вашем Bitrix24:

Перейдите в Настройки → Приложения → Вебхуки

Создайте новый вебхук с правами: crm, user

Скопируйте URL вебхука

Замените значение вебхука в коде

## Процесс работы
Скрипт последовательно выгружает:

Статусы и источники

Пользователей системы

Лиды (созданные после 1 сентября 2024)

Сделки (созданные после 1 сентября 2024)

Данные преобразуются и объединяются

Создаются два Excel-файла:

Выгрузка 1.xlsx: Полные данные по сделкам с информацией о лидах

Выгрузка 2.xlsx: Лиды с заполненным полем "Форма"

## Структура выходных данных
Выгрузка 1.xlsx (Сделки + Лиды):

Информация о сделке: Название, Сумма, Стадия, Ответственный, Типы сервисов

Информация о лиде: ФИО, Контакты, Компания, Источник

Выгрузка 2.xlsx (Лиды с форм):

Полная информация о лидах, пришедших через веб-формы

Все контактные данные и источник привлечения

## Важные заметки
Дата фильтра: Скрипт выгружает данные, созданные после 1 сентября 2024 года

Скорость выгрузки: Для сделок автоматически включается режим замедления для избежания ошибок API

Поля CRM: Код содержит кастомные поля UF_CRM_* - при переносе проверьте их актуальность в вашем Bitrix24

Обработка ошибок: При ошибках выгрузки скрипт покажет детали и предложит решения
